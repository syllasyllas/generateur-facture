<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G√©n√©rateur de Facture</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f7f6;
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            justify-content: center;
        }
        .conteneur {
            width: 100%;
            max-width: 800px;
        }
        .formulaire, .apercu-recu {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            margin-bottom: 20px;
        }
        h1, h2 {
            color: #1a2533;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
            margin-top: 0;
        }
        .champ {
            margin-bottom: 18px;
        }
        .champ-groupe {
            display: flex;
            gap: 20px;
        }
        .champ-groupe .champ {
            width: 100%;
        }
        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: #333;
        }
        input[type="text"], input[type="number"], textarea, select {
            width: calc(100% - 22px);
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 6px;
            transition: border-color 0.3s, background-color 0.3s;
        }
        select {
             width: 100%;
        }
        input:focus, textarea:focus, select:focus {
            border-color: #007bff;
            outline: none;
        }
        input:disabled {
            background-color: #e9ecef;
            cursor: not-allowed;
        }
        .checkbox-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        .checkbox-container label {
            margin-bottom: 0;
            font-weight: normal;
        }
        .bouton-groupe {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }
        button {
            display: inline-block;
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .bouton-principal {
            background-color: #007bff;
            color: white;
        }
        .bouton-principal:hover {
            background-color: #0056b3;
        }
        .bouton-secondaire {
            background-color: #6c757d;
            color: white;
        }
        .bouton-secondaire:hover {
            background-color: #5a6268;
        }
        
        #recu {
            border: 1px solid #e0e0e0;
            padding: 25px;
            border-radius: 8px;
        }
        .header-recu {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 20px;
            margin-bottom: 20px;
        }
        .logo {
            max-width: 220px;
        }
        .infos-entreprise {
            text-align: right;
            font-size: 14px;
            color: #555;
        }
        .corps-recu {
            margin-top: 20px;
        }
        .titre-facture {
            text-align: center;
            font-size: 2em;
            font-weight: bold;
            color: #333;
            margin-bottom: 20px;
        }
        .infos-transaction {
            display: flex;
            justify-content: space-between;
            margin-bottom: 25px;
        }
        .details-expedition, .details-contenu {
            margin-top: 20px;
            padding: 15px;
            background-color: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
        }
        .parties-container {
            display: flex;
            justify-content: space-between;
            gap: 20px;
        }
        .partie {
            width: 48%;
        }
        .partie strong, .details-expedition strong, .details-contenu strong {
            color: #007bff;
        }
        .table-contenu {
            width: 100%;
            margin-top: 10px;
            border-collapse: collapse;
        }
        .table-contenu th, .table-contenu td {
            border: 1px solid #e5e7eb;
            padding: 12px;
            text-align: left;
        }
        .table-contenu th {
            background-color: #f1f5f9;
            font-weight: 600;
        }
        .table-contenu td:nth-child(2), .table-contenu td:nth-child(3) {
            text-align: right;
        }
        .resume-financier {
            margin-top: 20px;
            padding-left: 50%;
        }
        .resume-financier table {
            width: 100%;
            border-collapse: collapse;
        }
        .resume-financier td {
            padding: 8px;
            border-bottom: 1px solid #eee;
        }
        .resume-financier .grand-total td {
            font-weight: bold;
            font-size: 1.2em;
            color: #D32F2F; /* Grand total en rouge */
            border-top: 2px solid #333;
        }
        .pied-recu {
            margin-top: 50px;
            padding-top: 20px;
            border-top: 1px solid #ccc;
            font-size: 12px;
            color: #666;
        }
        .note-importante {
            font-weight: bold;
            color: #D32F2F;
            background-color: #FFEBEE;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            margin-bottom: 20px;
        }
        .signatures {
            margin-top: 100px;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }
        .zone-signature {
            border-top: 1px solid #333;
            width: 45%;
            text-align: center;
            padding-top: 8px;
            font-size: 13px;
            height: 150px;
        }
        .signature-image {
            display: block;
            max-height: 200px;
            margin: -160px auto -15px auto;
        }

        @media print {
            body { background-color: white; display: block; padding: 0; margin: 0; }
            .formulaire, .bouton-imprimer, h2 { display: none; }
            .apercu-recu { box-shadow: none; width: 100%; padding: 0; margin: 0; }
            #recu { border: none; }
            .note-importante { background-color: #f0f0f0; }
        }
    </style>
</head>
<body>

    <div class="conteneur formulaire">
        <form id="invoiceForm">
            <h1>üìù G√©n√©rateur de Facture</h1>
            
            <!-- Infos Destinataire -->
            <div class="champ"><label for="clientNom">Nom & Pr√©nom du Destinataire</label><input type="text" id="clientNom" placeholder="Ex: Jean Dupont"></div>
            <div class="champ"><label for="clientContact">Contact du Destinataire</label><input type="text" id="clientContact" placeholder="Ex: 0102030405"></div>
            <div class="champ"><label for="clientVille">Ville de R√©sidence du Destinataire</label><input type="text" id="clientVille" placeholder="Ex: Abidjan"></div>
            <hr style="border: 1px solid #f0f0f0; margin: 25px 0;">
            
            <!-- Infos Exp√©diteur -->
            <div class="champ"><label for="expediteur">Nom de l'Exp√©diteur</label><input type="text" id="expediteur" placeholder="Nom de la personne qui d√©pose le colis"></div>
            <div class="champ"><label for="expediteurContact">Contact de l'Exp√©diteur</label><input type="text" id="expediteurContact" placeholder="Ex: 0708091011"></div>
            <div class="champ"><label for="expediteurPiece">N¬∞ Pi√®ce d'Identit√© (Exp√©diteur)</label><input type="text" id="expediteurPiece" placeholder="Ex: C00123456789"></div>
            <hr style="border: 1px solid #f0f0f0; margin: 25px 0;">

            <!-- Infos Colis -->
            <div class="champ"><label for="description">Description</label><textarea id="description" rows="2" placeholder="Ex: V√™tements, documents..."></textarea></div>
            <div class="champ-groupe">
                <div class="champ"><label for="unitType">Unit√©</label><select id="unitType"><option value="Poids/KG">Poids/KG</option><option value="CBM">CBM</option></select></div>
                <div class="champ"><label for="unitValue">Valeur de l'unit√©</label><input type="number" id="unitValue" placeholder="Ex: 5"></div>
            </div>
            <div class="champ"><label for="montant">Montant (FCFA)</label><input type="number" id="montant" placeholder="Ex: 25000"></div>
            <div class="champ"><label for="valeurColis">Valeur du Colis</label><input type="number" id="valeurColis" placeholder="Ex: 100000"></div>
            <div class="champ"><label for="prixDeclare">Prix D√©clar√© Pris en Compte</label><input type="number" id="prixDeclare" placeholder="Ex: 100000"></div>
            <div class="champ">
                <div class="checkbox-container"><input type="checkbox" id="hasReduction" onchange="toggleReductionInput()"><label for="hasReduction">Appliquer une r√©duction</label></div>
                <input type="number" id="reduction" placeholder="Saisir le montant de la r√©duction" disabled>
            </div>
            <div class="champ">
                 <div class="checkbox-container"><input type="checkbox" id="hasTracking" onchange="toggleTrackingInput()"><label for="hasTracking">Le colis a un num√©ro de tracking</label></div>
                <input type="text" id="tracking" placeholder="Saisir le num√©ro de tracking" disabled>
            </div>

            <div class="bouton-groupe">
                <button type="button" onclick="genererFacture()" class="bouton-principal">G√©n√©rer la Facture</button>
                <button type="button" onclick="reinitialiserFacture()" class="bouton-secondaire">R√©initialiser</button>
            </div>
        </form>
    </div>

    <div class="conteneur apercu-recu">
        <h2>Aper√ßu de la Facture</h2>
        <div id="recu">
            <div class="header-recu">
                <div><img src="https://i.postimg.cc/ncnzhbWX/Design-sans-titre-3.png" alt="Logo MONCOLIS.CI" class="logo"></div>
                <div class="infos-entreprise">
                    <strong>MONCOLIS.CI</strong><br>
                    <span style="font-size: 12px; color: #777;">Une repr√©sentation de EKF-CORPORATION</span><br><br>
                    Cocody Riviera Palmeraie, Rue Ministre, Abidjan<br>
                    T√©l√©phone : +225 07 49 75 55 19<br>
                    N¬∞ Registre : RVN: CI-ABJ-03-2021-B12-01877
                </div>
            </div>

            <div class="corps-recu">
                <div class="titre-facture">FACTURE</div>
                <div class="infos-transaction">
                    <div><strong>Date :</strong> <span id="facture-date">-</span><br><strong>N¬∞ Facture :</strong> <span id="facture-num">-</span></div>
                </div>

                <div class="details-expedition">
                    <div class="parties-container">
                        <div class="partie">
                            <strong>Destinataire :</strong><br>
                            Nom : <span id="facture-clientNom">-</span><br>
                            Contact : <span id="facture-clientContact">-</span><br>
                            Ville : <span id="facture-clientVille">-</span>
                        </div>
                        <div class="partie">
                            <strong>Exp√©diteur :</strong><br>
                            Nom : <span id="facture-expediteur">-</span><br>
                            Contact : <span id="facture-expediteurContact">-</span><br>
                            N¬∞ Pi√®ce d'Identit√© : <span id="facture-expediteurPiece">-</span>
                        </div>
                    </div>
                    <hr style="border: 0; border-top: 1px solid #e5e7eb; margin: 15px 0;">
                    <div><strong>Num√©ro de Tracking :</strong> <span id="facture-tracking">-</span></div>
                </div>

                <div class="details-contenu">
                    <strong>D√©tails du Contenu du Colis :</strong>
                    <table class="table-contenu">
                        <thead>
                            <tr>
                                <th>Description</th>
                                <th id="header-unit">Poids/KG</th>
                                <th>Montant</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td id="facture-description">-</td>
                                <td id="facture-unitValue">-</td>
                                <td id="facture-montant">-</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="resume-financier">
                        <table>
                            <tbody>
                                <tr><td>Valeur du Colis :</td><td style="text-align:right;"><span id="facture-valeurColis">0</span> FCFA</td></tr>
                                <tr><td>Prix D√©clar√© Pris en Compte :</td><td style="text-align:right;"><span id="facture-prixDeclare">0</span> FCFA</td></tr>
                                <tr id="ligne-reduction" style="display:none;"><td>R√©duction :</td><td style="text-align:right;">- <span id="facture-reduction">0</span> FCFA</td></tr>
                                <tr class="grand-total"><td>GRAND TOTAL :</td><td style="text-align:right;"><span id="facture-grandTotal">0</span> FCFA</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="pied-recu">
                <p class="note-importante">Important : Les charges de la douane sont √† la responsabilit√© exclusive du client.</p>
                <div class="signatures">
                    <div class="zone-signature">Signature de l'Exp√©diteur</div>
                    <div class="zone-signature">
                        <img src="https://i.postimg.cc/15WW3FHb/Untitled-design.png" alt="Signature de l'agence" class="signature-image">
                        Signature de l'Agence
                    </div>
                </div>
            </div>
        </div>
        <button class="bouton-principal" onclick="window.print()" style="margin-top:20px;">üñ®Ô∏è Imprimer la Facture</button>
    </div>

    <script>
        function toggleTrackingInput() {
            const trackingInput = document.getElementById('tracking');
            const hasTrackingCheckbox = document.getElementById('hasTracking');
            trackingInput.disabled = !hasTrackingCheckbox.checked;
            if (!hasTrackingCheckbox.checked) {
                trackingInput.value = '';
            }
        }
        
        function toggleReductionInput() {
            const reductionInput = document.getElementById('reduction');
            const hasReductionCheckbox = document.getElementById('hasReduction');
            reductionInput.disabled = !hasReductionCheckbox.checked;
            if (!hasReductionCheckbox.checked) {
                reductionInput.value = '';
            }
        }

        function reinitialiserFacture() {
            document.getElementById('invoiceForm').reset();
            
            const fieldsToReset = [
                'facture-date', 'facture-num', 'facture-clientNom', 'facture-clientContact', 
                'facture-clientVille', 'facture-expediteur', 'facture-expediteurContact', 
                'facture-expediteurPiece', 'facture-tracking', 'facture-description', 'facture-unitValue'
            ];
            fieldsToReset.forEach(id => {
                document.getElementById(id).innerText = '-';
            });
            
            document.getElementById('facture-montant').innerText = '-';
            document.getElementById('facture-valeurColis').innerText = '0';
            document.getElementById('facture-prixDeclare').innerText = '0';
            document.getElementById('facture-grandTotal').innerText = '0';
            document.getElementById('ligne-reduction').style.display = 'none';

            toggleTrackingInput();
            toggleReductionInput();
        }

        function genererFacture() {
            const maintenant = new Date();
            const dateStr = maintenant.toLocaleDateString('fr-FR', { day: '2-digit', month: '2-digit', year: 'numeric' });
            const numFacture = 'FACT-' + maintenant.getTime(); 

            // R√©cup√©ration des valeurs
            const clientNom = document.getElementById('clientNom').value;
            const clientContact = document.getElementById('clientContact').value;
            const clientVille = document.getElementById('clientVille').value;
            const expediteur = document.getElementById('expediteur').value;
            const expediteurContact = document.getElementById('expediteurContact').value;
            const expediteurPiece = document.getElementById('expediteurPiece').value;
            const description = document.getElementById('description').value;
            const unitType = document.getElementById('unitType').value;
            const unitValue = document.getElementById('unitValue').value;
            const montant = parseFloat(document.getElementById('montant').value) || 0;
            const valeurColis = document.getElementById('valeurColis').value;
            const prixDeclare = document.getElementById('prixDeclare').value;
            
            let reduction = 0;
            if (document.getElementById('hasReduction').checked) {
                reduction = parseFloat(document.getElementById('reduction').value) || 0;
            }
            
            let trackingValue = "Non applicable";
            if (document.getElementById('hasTracking').checked) {
                trackingValue = document.getElementById('tracking').value || "-";
            }
            
            // Calculs
            const grandTotal = montant - reduction;

            // Remplissage de la facture
            document.getElementById('facture-date').innerText = dateStr;
            document.getElementById('facture-num').innerText = numFacture;
            document.getElementById('facture-clientNom').innerText = clientNom || "-";
            document.getElementById('facture-clientContact').innerText = clientContact || "-";
            document.getElementById('facture-clientVille').innerText = clientVille || "-";
            document.getElementById('facture-expediteur').innerText = expediteur || "-";
            document.getElementById('facture-expediteurContact').innerText = expediteurContact || "-";
            document.getElementById('facture-expediteurPiece').innerText = expediteurPiece || "-";
            document.getElementById('facture-tracking').innerText = trackingValue;
            
            // Remplissage du tableau
            document.getElementById('header-unit').innerText = unitType;
            document.getElementById('facture-description').innerText = description || "-";
            document.getElementById('facture-unitValue').innerText = unitValue || "-";
            document.getElementById('facture-montant').innerText = montant.toLocaleString('fr-FR') + " FCFA";
            
            // Remplissage du r√©sum√© financier
            document.getElementById('facture-valeurColis').innerText = (valeurColis || "0").toLocaleString('fr-FR');
            document.getElementById('facture-prixDeclare').innerText = (prixDeclare || "0").toLocaleString('fr-FR');
            
            const ligneReduction = document.getElementById('ligne-reduction');
            if (reduction > 0) {
                document.getElementById('facture-reduction').innerText = reduction.toLocaleString('fr-FR');
                ligneReduction.style.display = 'table-row';
            } else {
                ligneReduction.style.display = 'none';
            }
            
            document.getElementById('facture-grandTotal').innerText = grandTotal.toLocaleString('fr-FR');
        }
    </script>
</body>
</html>
